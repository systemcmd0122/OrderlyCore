<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Overseer - ダッシュボード</title>
    <link href="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/css/tom-select.bootstrap5.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Noto+Sans+JP:wght@300;400;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>
    <style>
        /* 追加のダッシュボード専用スタイル */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .message.error.show {
            background-color: var(--error-color);
            color: white;
            padding: 15px;
            border-radius: var(--border-radius);
            text-align: center;
        }
        
        /* Tom Select カスタマイズ */
        .ts-wrapper.single .ts-control {
            min-height: 44px;
        }
        
        .ts-wrapper.single .ts-control,
        .ts-wrapper.single .ts-control input {
            color: var(--text-color) !important;
        }
        
        .ts-dropdown .option,
        .ts-dropdown .optgroup-header {
            color: var(--text-color) !important;
        }
        
        .ts-dropdown .option:hover {
            background-color: var(--surface-light-color) !important;
        }
        
        /* ローディング状態の改善 */
        .page-content .loader-ring {
            margin: 80px auto;
        }
        
        /* モーダルのスクロール改善 */
        .modal-body {
            max-height: 60vh;
            overflow-y: auto;
        }
        
        /* ロールアイテムの見た目改善 */
        .role-item {
            transition: background-color 0.2s ease;
        }
        
        .role-item:hover {
            background-color: var(--surface-color);
        }
        
        /* フォームグリッドの改善 */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            align-items: start;
        }
        
        /* ボタンアニメーション */
        .btn {
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        /* カードホバーエフェクト */
        .card {
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
        }
        
        /* レスポンシブ改善 */
        @media (max-width: 480px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .card-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .modal {
                width: 95%;
                margin: 10px;
            }
            
            .color-input-wrapper {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <div id="loader" class="loader-container">
        <div class="loader-ring"></div>
        <p>サーバー情報を読み込み中...</p>
    </div>

    <div class="dashboard-wrapper" style="display: none;">
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="/" class="logo">[O] Overseer</a>
            </div>
            
            <div class="server-info">
                <img id="server-icon" src="" alt="Server Icon" class="server-icon">
                <h2 id="server-name">サーバー名</h2>
            </div>
            
            <nav class="sidebar-nav">
                <a href="#dashboard" class="nav-item active" data-page="dashboard">
                    <i data-feather="grid"></i>
                    <span>ダッシュボード</span>
                </a>
                <a href="#analytics" class="nav-item" data-page="analytics">
                    <i data-feather="bar-chart-2"></i>
                    <span>アナリティクス</span>
                </a>
                <a href="#announcements" class="nav-item" data-page="announcements">
                    <i data-feather="bell"></i>
                    <span>お知らせ設定</span>
                </a>
                <a href="#welcome" class="nav-item" data-page="welcome">
                    <i data-feather="user-plus"></i>
                    <span>参加・退出設定</span>
                </a>
                <a href="#welcome-message" class="nav-item" data-page="welcome-message">
                    <i data-feather="mail"></i>
                    <span>ウェルカムメッセージ</span>
                </a>
                <a href="#roleboard" class="nav-item" data-page="roleboard">
                    <i data-feather="trello"></i>
                    <span>ロールボード</span>
                </a>
                <a href="#autorole" class="nav-item" data-page="autorole">
                    <i data-feather="user-check"></i>
                    <span>Bot 自動ロール</span>
                </a>
                <a href="#automod" class="nav-item" data-page="automod">
                    <i data-feather="shield"></i>
                    <span>オートモッド</span>
                </a>
                <a href="#logging" class="nav-item" data-page="logging">
                    <i data-feather="edit-3"></i>
                    <span>ログ設定</span>
                </a>
                <a href="#leveling" class="nav-item" data-page="leveling">
                    <i data-feather="trending-up"></i>
                    <span>レベリング</span>
                </a>
                <a href="#ai" class="nav-item" data-page="ai">
                    <i data-feather="cpu"></i>
                    <span>AI設定</span>
                </a>
            </nav>
            
            <div class="sidebar-footer">
                <button id="logout-btn" class="btn btn-secondary">
                    <i data-feather="log-out"></i>
                    <span>ログアウト</span>
                </button>
            </div>
        </aside>
        
        <main class="main-content">
            <header class="main-header">
                <button id="menu-toggle" class="menu-toggle-btn">
                    <i data-feather="menu"></i>
                </button>
                <h1 id="page-title">ダッシュボード</h1>
            </header>
            
            <div id="page-content-wrapper">
                <div id="page-content" class="page-content">
                    <!-- コンテンツはJavaScriptで動的に生成されます -->
                </div>
            </div>
        </main>
    </div>

    <!-- モーダルコンテナ -->
    <div id="modal-container"></div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/js/tom-select.complete.min.js"></script>
    <script src="/client.js"></script>
    
    <script>
        // エラーハンドリング
        window.addEventListener('error', (e) => {
            console.error('Global error:', e.error);
        });
        
        // 未処理のPromise拒否をキャッチ
        window.addEventListener('unhandledrejection', (e) => {
            console.error('Unhandled promise rejection:', e.reason);
        });
    </script>
</body>
</html>